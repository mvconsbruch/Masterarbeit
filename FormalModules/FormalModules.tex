%! TeX root: ../main.tex
\documentclass[../main.tex]{subfiles}

\begin{document}

\section{Formal Modules}
This section will serve as an introduction to formal groups and 
formal modules. Formal groups (or rather, formal group laws) were first
introduced by \textsc{Salomon Bochner} in 1946 as a natural means of studying Lie
Groups over fields of characteristic $0$, cf. \cite{Bochner1946FGrps}. 
The study of formal groups later became interesting for its own right, 
with pioneering works of Lazard \cite{Lazard1955FGrps}. \todo{blabla}

\subsection{Basic Notions} % (fold)
\label{sub:Basic Notions}
As promised in the introduction, we begin by defining {formal group
laws}.
For now, let $A$ be any ring.
\begin{defi}[Formal Group Laws of arbitrary dimension]
  A (commutative) formal group law  of dimension
  $n$ over $R$ is a tuple of
  power series $F = (F_1, \dots, F_n)$ with $$F_i(X_1, \dots, X_n,Y_1,
  \dots, Y_n) \in R\llbr X_1, \dots,
  X_n, Y_1, \dots, Y_n\rrbr, \quad 1 \leq i \leq n$$
  such that $F_i(\mathbf X, \mathbf Y) \equiv X_i + Y_i $ modulo degree $\geq 2$
  and the following equalities are satisfied:
  \begin{enumerate}
    \item $F(F (\mathbf X, \mathbf Y), \mathbf Z) = 
      F(\mathbf X, F(\mathbf Y, \mathbf Z))$.
    \item $F( \mathbf X, \mathbf 0) = \mathbf X$.
    \item $F( \mathbf X, \mathbf Y) = F(\mathbf Y, \mathbf X).$
  \end{enumerate}
  Here, and in the sequel, we abbreviate $\mathbf X =
  (X_1, \dots, X_n)$, et cetera.
  Given a formal group $F$ of dimension $n$ and a formal group law
  $G$ of dimension $m$,
  a morphism $F \to G$ is a $m$-tuple $f = (f_1, \dots, f_m)$ 
  of power series $f_i \in R\llbr X_1, \dots, X_n \rrbr$ such that $\bff(0)=0$ and
  \begin{equation*}
    G(f( \mathbf X), f( \mathbf Y) ) = f(F( \mathbf X, \mathbf Y)).
  \end{equation*}
  For any $n$-dimensional formal module $F$, the identity is given by 
  the morphism $\id_{F}$ with components $\id_{F,i}( \mathbf X) = X_i$. 
  Composition of morphisms is given by composition of tuples of power-series.
  This yields the category of formal modules of arbitrary dimension over $R$,
  which we denote by $\FGLArbOver R$. We will mostly be concerned with the full
  subcategory of one-dimensional formal groups, which we denote by $\FGLOver R$. 
\end{defi}

\begin{lem}\label{lem:FGLAdditive}
  \begin{enumerate}
    \item The set $\Hom_{\FGLArbOver R} (F,G)$
      is an abelian group with addition $f+g = G(f,g)$. 
      In particular, $\FGLArbOver R$ is pre-additive (cf.
      \cite[\href{https://stacks.math.columbia.edu/tag/00ZY}{Tag
      00ZY}]{stacks-project}).     
    \item Furthermore, $\FGLArbOver R$ admits finite products. Thereby it is 
      an additive category (cf. \cite[\href{https://stacks.math.columbia.edu/tag/0104}{Tag
      0104}]{stacks-project}).
      The unique final and initial object of $\FGLArbOver R$ is the unique
      $0$-dimensional formal $A$-module law.
    \item In particular $\End_{\FGLArbOver R}(F)$ is a (possibly non-commutative)
      ring.
  \end{enumerate}
\end{lem}

\begin{xpl} Let us introduce the following two formal group laws.
  \begin{itemize}
    \item \textit{The additive formal group law}. Write 
      $\Ghat_a$ for the formal group law with addition given by 
      $\Ghat_a(X,Y) = X + Y$. 
    \item We write $\Ghat$ for the formal group law associated with the 
      with $\Ghat(X,Y) = X + Y + XY$. Note that $\Ghat(X,Y) = (X+1)(Y+1) - 1$
  \end{itemize}
\end{xpl}

Next up is the definition of formal $A$-module laws. Naively, we would like to 
define formal $A$-module laws as formal group laws $F$
with $A$-module structure, i.e. a morphism of rings $[\cdot]_F: A \to
\End_\FGLArbOver R(F)$. But there is a subtlety, which becomes evident after defining
the Lie-algebra of a formal group law. 
\begin{defi}[Lie-algebra of formal group law]
Let $\Lie: \FGLArbOver R \to \Ab$ be the functor taking an $n$-dimensional 
formal group law $F$ to the $R$-module
\begin{equation*}
  \Lie(\bF) = \Hom_{\Mod R} \left( \frac{(X_1, \dots, X_n)}{(X_1, \dots,
  X_n)^2}, R \right) 
\end{equation*}
Given an $m$-dimensional group law $\bG$ and a morphism $\bff: \bF \to
\bG$, $\Lie(\bff)$ is the induced morphism
\begin{equation*}
  \Lie(\bF) \to \Lie(\bG), \quad \psi \mapsto \left( S_j \mapsto \psi
  (\overline{f_j})\right) \in 
  \Hom_\Mod R\left(\frac{(X_1, \dots, X_n)}{(X_1, \dots, X_n)^2}, R \right),
\end{equation*}
where $\overline{ f_j}$ is the reduction of $f_j$ mod $(\bX)^2$. 
\end{defi}
We have a canonical basis on both sides, and writing $\Lie(\bF) = R^n$, 
$\Lie(\bG) \cong R^m$, the induced map $\Lie(\bff) : R^n \to R^m$ is
given by multiplication with the matrix 
\begin{equation*}
  \left( \frac {\partial f_i}{\partial X_j} (0) \right)_{\substack{1 \leq i \leq m \\ 1 \leq j \leq n}}.
\end{equation*}

Given a one-dimensional group law $F \in \FGLOver R$, the condition that 
$F(X,Y) \equiv X+Y$ modulo degree $\geq 2$ enforces that the induced map
$\End(F) \xto{\Lie} \End(R)$ is a morphism of rings. 
If we are given $[-]_F: A \to \End_{\FGLOver R}(F)$, this $A$-module structure on $F$ 
yields an $A$-module structure on $R$, given by the composition
\begin{equation*}
  A \xto{[\cdot]_F} \End(F) \xto{\Lie} \End(R), \quad a \mapsto \Lie([a]_F)
\end{equation*}
This is a morphism of rings, and we obtain an $A$-algebra structure on $R$. 
This motivates the following definition.
\begin{defi}[Formal $A$-Module Law of arbitrary dimension]\label{def:formalmodulelaw}
  Let $R$ be an $A$-algebra with structure morphism $j: A \to R$. A formal
  $A$-module law over $R$ of dimension $n$ is given by the data of 
  a formal $n$-dimensional group law $F$ over $R$ and a morphism of rings
  \begin{equation*}
    A \to \End_{\FGLArbOver R} (F), \quad a \mapsto ([a]_{F,i}
    )_{1 \leq i \leq n} \in (R \llbr X_1, \dots, X_n \rrbr )^n
  \end{equation*}
  such that $[a]_{F,i}(\mathbf X) \equiv j(a) X_i$ modulo terms of degree 
  $\geq 2$. Morphisms between formal $A$-modules of arbitrary dimension are 
  morphisms of formal groups respecting the $A$-module structure. 
  The resulting category is denoted $\FMLArbOver A R$. As before, the full
  subcategory of one-dimensional formal $A$ modules over $R$ is denoted 
  $\FMLOver A R$.
\end{defi}

Note that $\FGLOver R \cong \FMLOver \Z R$.
Slightly abusing notation, we usually do not explicitely mention the $A$-structure
when referring to formal module laws, simply writing $F \in \FMLOver AR$, for
example. 

The following lemma explains the functoriality of the assignment
$R \mapsto \FMLArbOver A R$.

\begin{lem}\label{lem:FMLFunc}
  The assignment $R \mapsto \FMLArbOver A R$ is functorial in the following sense.
  If $i: R \to R'$ is a morphism of $A$-algebras, we obtain a functor
  \begin{equation*}
    \FMLArbOver A R \to \FMLArbOver A {R'}, \quad F \mapsto F \otimes_R R',
  \end{equation*}
  where $F \otimes_R R'$ is the formal $A$-module law obtained by applying $i$
  to the coefficients of the formal power series representing the $A$-module
  structure of $F$. 
\end{lem}

Note that every $n$-dimensional formal module law $F \in \FMLArbOver A R$
yields a functor
\begin{equation}\label{eq:fmnilpfunc}
  \Alg R \to \Mod A, \quad S \mapsto \Nil(S)^n,
\end{equation}
where $\Nil(S)^n$, the set of $n$-tuples of nilpotent elements of $S$, is equipped with
addition and scalars given by 
\begin{equation*}
  s_1 + s_2 = F(s_1, s_2) \in \Nil(S)^n, \quad a s = [a]_F(s) \in \Nil(S)^n.
\end{equation*}
This construction yields a functor 
\begin{equation}\label{eq:formfunc}
  \FMLOver A R \to \Fun(\Alg R, \Mod A),
\end{equation}
where $\Fun$ denotes the functor category.

Passing from discrete $R$-algebras to admissible $R$-algebras (cf. Definition
\ref{def:admring}), this construction extends naturally to a functor 
\begin{equation*}
  \FMLOver AR \to \Fun (\Adm R, \Mod A), \quad F \mapsto \Spf R\llbr \bT \rrbr,
\end{equation*}
where we equip $\Spf R \llbr \bT \rrbr$ with the structure of an $A$-module object
using the endomorphisms coming from $F$. 
Following this line of thought leads naturally to the definition of
formal modules. 

\begin{defi}[Formal Groups and Formal Modules.]
  Given an $A$-scheme $X$, we define the category
  $\FMArbOver A X$ as follows. 
  Objects are $A$-module objects $\cF$ in the category
  of formal schemes over $X$, having the property that 
  there is a cover of $X$ by Zariski-open affine subsets $U_i = \spec (R_i)$
  such that $\cF \times_X U_i$ is isomorphic to $\Spf R_i\llbr X_1, \dots,
  X_n\rrbr$ and the induced $A$-module structure on $\spf R_i\llbr X_1, \dots, X_n\rrbr$
  yields a formal $A$-module law on $R_i$. Given $\cF, \cG \in \FMLArbOver AX$,
  a morphism $\phi: \cF \to \cG$ is the same as a morphism of $A$-module objects 
  in the category of formal schemes over $X$.
  Again, we denote the full subcategory of one-dimensional formal $A$-modules
  over $X$ by $\FMOver AX$. 
\end{defi}

\begin{rmk} 
  Formal schemes (over a base an $A$-scheme $X$, say) locally isomorphic to 
  $\spf \cO_X(U)\llbr \bT \rrbr$ are sometimes called Formal
  Lie Varieties \todo{reference}. Equivalently to the definition above, we could
  have defined formal $A$-modules as $A$-module objects in the category of
  Formal Lie Varieties, such that the $A$-module structure
  on the tangent space at the identity agrees with the usual one.
\end{rmk}

\begin{defi}[Coordinate]
  Let $\cF$ be a formal $A$-module over $X$. The choice of a cover $\sqcup_{i
  \in I} \spec(R_i) \to X$ together with isomorphisms $\cF \times_X \spec(R_i)
  \cong \Spf(R_i\llbr \bT \rrbr)$ will be referred to as a coordinate of $\cF$. 
\end{defi}

Of course there is a functor 
\begin{equation*}
  \FGG: \FMLArbOver AR \to \FMArbOver AR,
\end{equation*}
essentially forgetting the choice of module law. The observation of Lemma 
\ref{lem:FMLFunc} remains valid in the category formal modules, a morphism $j : R \to R'$ 
yields a functor 
\begin{equation*} 
  \FMOver AR \to \FMOver A{R'}, \quad \cF \mapsto \cF \otimes_R R'.
\end{equation*}

\begin{defi}[Lie functor]
  The functor $\Lie$ descends to a functor 
  \begin{equation*}
    \Lie: \FMArbOver A X \to \QCoh {\cO_X}, 
  \end{equation*}
  given by locally describing a formal $A$-module $\cF$ via formal group laws and gluing the local data. Alternatively, it arises from sending 
  sending a formal $A$-module $\cF$ to $(\cI / \cI^2)^\vee$, where $\cI$ is the
  ideal associated to the closed immersion $[0]_\cF: X \to \cF$. 
\end{defi}

\begin{lem}\label{lem:IsosCheckOnLie}
  A map $\phi: \cF \to \cG$ of formal $A$-modules (of arbitrary dimension) over $X$ is an isomorphism if and only if the induced morphism of Lie algebras $\Lie(\phi): \Lie(\cF) \to \Lie(\cG)$ is an isomorphism.
\begin{proof}
  This is easily verified in the one-dimensional situation after choosing coordinates.
  The general case adds no complication. 
\end{proof}
\end{lem}


\begin{xpl}
  The additive group law $\Ghat_a$ extends to a formal $A$-module over an affine base $\spec R$ by setting 
  \begin{equation*}
    [a]_{\Ghat_a}(T) = aT
  \end{equation*}
  for $a \in A$. More generally, we obtain a formal $A$-module over an arbitrary base scheme $X$ over $A$.

  Over $\Z_p$, the formal group $\Ghat$ extends to a formal $\Z_p$-module as follows. 
  As a functor, $\Ghat$ is isomorphic to the assignment
  \begin{equation*}
    \Adm {\Z_p} \to \Ab, \quad S \mapsto 1 + S^\cici \subset S^\times.
  \end{equation*}
  Here, we equipped $\Z_p$ with the $p$-adic topology.
  The subgroup $1 + S^\cici$ naturally carries the structure of a $\Z_p$-module.
  Indeed, for $k \in \N$, we have
  \begin{equation*}
    (1+s)^{p^k} = 1 + p^ks + \binom{p^k}2 s^2 + \dots + s^{p^k},
  \end{equation*}
  and given $s \in S^\cici$, this is of the form $1+ o(1)$ as $k$ gets large. 
  In particular, if $x = a_0 + a_1 p + a_2p^2 + \dots \in \Z_p$, expressions of  the form
  \begin{equation*}
    (1+s)^x = \prod_{i = 1}^\infty (1+s)^{a_k p^k}
  \end{equation*}
  make sense by Lemma \ref{lem:infiniteseriesandproducts}. This gives
  $\Ghat_{m,\Z_p}$ the structure of a formal $\Z_p$-module. 
  In the upcoming subsection, we discuss how this is the simplest example of a
  whole family of formal modules constructed by 
  Lubin and Tate. In Section \ref{sec:Local Class Field Theory} we explain applications of these formal modules to local class field theory.
\end{xpl}

\begin{defi}[Formal Module associated to $R$-module]
  \label{def:additiveformalmoduleassociatedtomodule}
  Suppose that $M$ is a finite projective $R$-module. Then we write
  $\Ghat_a \otimes M$ for the additive formal $A$-module associated to $M$ over $R$.
  As a formal scheme, this formal module is given by
  \begin{equation*}
    \Ghat_a \otimes M \cong \spf R \llbr M^\vee \rrbr,
  \end{equation*}
  where $R \llbr M^\vee \rrbr$ denotes the completion of $\Sym_R(M^\vee)$ with respect
  to the ideal generated by $M^\vee$. The (formal) $A$-module structure is the
  canonical additive one. 
  Note that $\Lie(\Ghat_a \otimes M) = M$ by design. 
  More generally, if $X$ is a quasi-compact and quasi-separated $A$-scheme
  and $\cM$ is a finite locally free quasi-coherent 
  $\cO_X$-module, this construction yields a formal $A$-module
  $\Ghat_a \otimes \cM$ over $X$.
\end{defi}
\begin{rmk} 
  If $R\to R'$ is a ring morphism that turns $R'$ into a (say) finite free
$R$ -algebra, the above definition overloads the expression $\Ghat_a \otimes_R R'$.
  In order to disambiguate, we usually denote the additive formal $A$-module
  over $R'$ by $\Ghat_{a, R'}$. 
\end{rmk}

% subsection Basic Notions (end)

\subsection{Lubin--Tate Formal Module Laws} % (fold)
\label{sub:Lubin--Tate Formal Module Laws}
We sketch the construction of a family of formal modules introduced by 
Lubin and Tate in \cite{LubinTateFormalMult}.

Let $A$ be a complete discrete valuation ring with 
finite residue field $k$, set $q = \# k$ and let $\varpi \in A$ be a choice of
uniformizer.
Write $\cF_{\varpi, h}$ for the following set of power series
\begin{equation*}
  \cF_\varpi \coloneqq \{f \in \cO_K \llbr T \rrbr \mid f \equiv \varpi T \pmod {T^2}
  \text{ and } f \equiv T^{q^n} \pmod \varpi\}. 
\end{equation*}

The construction of the Lubin--Tate formal module laws is based on the following 
lemma, which is Lemma 1 in \cite{LubinTateFormalMult}.
\begin{lem}\label{lem:LTLemma1}
  Let $f(T)$ and $g(T)$ be elements of $\cF_{\varpi,h}$ and let 
  $L(X_1, \dots, X_n) = \sum_{i=1}^n a_i X_i$ be a linear form with coefficients in 
  $A$. Then there exists a unique series $F(X_1, \dots, X_n)$ with coefficients 
  in $A$ such that 
  \begin{gather*}
    F(X_1, \dots, X_n) \equiv L(X_1, \dots, X_n) \pmod {T^2}, \\ \text{and} \\
    f(F(X_1, \dots, X_n)) = F(g(X_1), \dots, g(X_n)).
  \end{gather*}
\end{lem}

As a direct consequence, we obtain the following useful result.
\begin{lem}
  Let $f \in \cF_{\varpi, h}$. Then there is a unique formal $A$-module law $F_f$ over $A$
  with $[\varpi]_F(T) = f(T)$.
\begin{proof}
  In the above lemma, set $L(X,Y) = X+Y$ and $g=f$ to uniquely determine 
  the power series $F_f$. The same Lemma yields unique power series
  $[a]_{F_f}(T) \in R\llbr T \rrbr$ by setting $L(T) = a T$, $g=f$. It is
  routine to check that $(F_f, ([a]_f)_{a \in A})$ is a formal $A$-module law, 
  cf. \cite{LubinTateFormalMult}.
\end{proof}
\end{lem}

\begin{defi}[Lubin--Tate Module Law]
  We refer to module laws arising from the construction above as Lubin--Tate module laws.
\end{defi}

Furthermore, attached to each $a \in \cO_K$ and $f,g \in \cF_{\varpi,h}$, we find
unique $[a]_{f,g}(T) \in \cO_K\llbr T \rrbr$ satisfying
\begin{equation}\label{eq:LTMoLaScaCond}
  [a]_{f,g}(T) \equiv aT \pmod {(T)^2} \quad \text{and} \quad
  f([a]_{f,g}(T)) = [a]_{f,g}(g(T)).
\end{equation}
We now have the following theorem.
\begin{thm}[Lubin--Tate Formal $\cO_K$-Module Laws]\label{thm:LTModLaw}
  Let $K$ be a local field with ring of integers $\cO_K$. For any choice of 
  uniformizer $\varpi \in \cO_K$ and any $f \in \cF_{\varpi,h}$, the family of power
  series $(F_f, ([a]_{f,f})_{a \in \cO_K})$
  gives rise to a formal $\cO_K$-module law over $\cO_K$. For 
  $f,g \in \cF_{\varpi,h}$, the formal $\cO_K$-module laws $F_f$ and $F_g$ are
  canonically isomorphic, via the morphism induced by $[1]_{f,g} \in \cO_K\llbr
  T \rrbr$. 
\begin{proof}
  See Theorem 1 of \cite{LubinTateFormalMult} and the subsequent discussion.
\end{proof}
\end{thm}
In particular, up to canonical isomorphism, there is only one Lubin--Tate formal
$\cO_K$-module law over $\cO_K$ attached to the choice of the uniformizer $\varpi \in
\cO_K$. 

\begin{xpl}
  If $K = \Q_p$, this reconstructs the multiplicative formal 
  $\Z_p$ module $\Ghat$ constructed above. Indeed, we have 
  \begin{equation*}
    \cF_p = \{f \in \Z_p\llbr T \rrbr \mid f(T) \equiv T^p \text{ mod } p
    \text{ and } f(T) \equiv pT \text{ mod } (T)^2 \},
  \end{equation*}
  implying that $f(T) = (1+T)^p-1$ lies in $\cF_p$.  
  One quickly checks that 
  \begin{equation*}
    F_f(X,Y) = (1+X)(1+Y) - 1 = X + Y + XY \in \Z_p \llbr X,Y \rrbr
  \end{equation*}
  is the addition law associated to $f$, and that 
  for $a \in \Z_p$, the power series
  \begin{equation*}
    [a]_{f,f} = (1+T)^{a} - 1 \in \Z_p \llbr T \rrbr
  \end{equation*}
  satisfies the condition of \eqref{eq:LTMoLaScaCond}. 
\end{xpl}

% subsubsection Lubin--Tate Formal Module Laws (end)

\subsection{Logarithms} % (fold)
\label{sub:Logarithms}
Again, $A$ is a complete discrete valuation ring with uniformizing parameter 
$\varpi$ and finite residue field $k = A/\varpi A$. We write $q$ for the cardinality of 
$k$ and $K$ for the field of fractions of $A$. Let $R$ be a local,
admissible $A$-algebra with structure map $i: A \to R$.

We review results from Sections
2 and 3 of \cite{hopkins1994equivariant}. 
Suppose that $\bF = (F_1, \dots, F_n)$ is a $n$-dimensional formal $A$-module
law over $R$. We abbreviate $\bX = (X_1, \dots, X_n)$, $\bY = (Y_1,
\dots, Y_n)$, etc.

\begin{defi}[Invariant Differentials]
  The module $\omega(\bF)$ of invariant differentials is the submodule of the
  $R$-module of differentials
  \begin{equation*}
    \Omega_{R\llbr T_1, \dots, T_n \rrbr/R} \cong \bigoplus_{i=1}^n R\llbr T_1, \dots, T_n
    \rrbr \dc T_i,
  \end{equation*}
  consisting of those $\omega \in \omega(\bF)$ satisfying
  \begin{equation}\label{eq:diffcond}
    \omega(\bF(\bX,\bY)) = \omega(\bX) + \omega(\bY)\quad \text{and} \quad
    \omega([a]_\bF(\bX)) = a\omega(\bX).
  \end{equation} 
  for all $a \in A$. 
\end{defi}

It is possible to explicitly calculate a basis for the $R$-module
$\omega(\bF)$, which we now explain. Let 
$$A(\bX, \bY) \in \Mat_{n \times n} (R\llbr \bX, \bY \rrbr)$$ 
denote the matrix $\left((\partial/\partial X_j)F_i (\bX,\bY)\right)_{i,j}$,
the derivative of $\bF(\bX,\bY)$ with respect to $\bX$. Set 
$B(\bY) = A(0,\bY)$. Then $B$ is a unit in $\Mat_{n \times n} R\llbr \bY \rrbr$; 
and we write $(C_{ij}(\bY))$ for the components of 
$B(\bY)^{-1}$. We now construct 
$$\omega_{i} \coloneqq \sum_{j=1}^n C_{ij}(\bX) \dc X_j \in \Omega_{R\llbr \bX \rrbr/R}$$ 
for $1 \leq i \leq n$. By definition we have 
\begin{equation}\label{eq:coeffofcanonicaldiff}
  C_{ij}(0) = \begin{cases}
    1 &\text{ if }i = j,\\
    0 &\text{ otherwise.}
  \end{cases}
\end{equation}
Checking that $\omega_{i}$ is an invariant differential is a matter of 
applying the chain rule. 
\begin{prop}
    The $R$-module $\omega(\bF)$ is free of rank $n$ generated by invariant differentials
    $\omega_{1}, \omega_{2}, \dots, \omega_{n}$.
\begin{proof}
  This is \cite[Proposition 1.1]{1970HondaFormalGroups}. 
\end{proof}
\end{prop}
\begin{xpl}
  The invariant differentials for $\Ghat_a$ are spanned by the form $\dc X$. 
  The invariant differentials for $\Ghat$ are spanned by the form 
  $\omega_1(X) = \frac 1{1+X} \dc X$.
\end{xpl}
By the Proposition above and Equation \eqref{eq:coeffofcanonicaldiff}, we may
define a pairing
\begin{equation*}
  \omega(\bF) \times \Lie(\bF) \to R, \quad \langle X_i, \omega_j \rangle =
  \begin{cases}
    1 &\text{ if } i = j,\\
    0 &\text{ otherwise.}
  \end{cases}
\end{equation*}
This pairing is independent of the parameterization of $\bF$. In particular, it
descends to a pairing defined for formal modules $\cF \in \FMArbOver A R$, and
we have a natural isomorphism $\omega(\cF) \cong \Hom_R(R, \Lie(\cF))$.

Let $\Ghat_a$ be the additive formal $A$-module over $R$. There is a map
\begin{equation} \label{eq:functorinvdifftohom}
  \dc_\bF : \Hom_{\FMLOver AR} (\bF, \Ghat_{a,R}) \to \omega(\bF), \quad f \mapsto \dc f(\bX)
\end{equation}
which is a map of $R$-modules if we equip the left hand side with the $R$-module
structure coming from the natural action of $R \subset \End(\Ghat_a)$. 
\begin{prop}\label{prop:loginvdiff}
  \begin{enumerate}
    \item If $R$ is a flat $A$-algebra, the map $\dc_F$ is injective.
    \item If $R$ is a $K$-algebra, the map $\dc_F$ is an isomorphism.
  \end{enumerate}
\begin{proof}
  This is \cite[Proposition 3.2]{hopkins1994equivariant}.
\end{proof}
\end{prop}

Suppose now that $F \in \FMLArbOver A R$ is a formal module law of dimension $n$
over a flat $A$-algebra $R$. 
Let $\omega_1, \dots, \omega_n$ be the distinguished basis for $\omega(F)$
constructed above. 
By the previous proposition, there are unique power series 
$f_i(\bX) \in (R \otimes_A K)\llbr \bX \rrbr$ that furnish homomorphisms
$F \otimes (R \otimes_A K) \to \Ghat_{a,R\otimes_AK}$ of formal $A$-module laws
and satisfying
\begin{equation*}
  \dc_F f_i(\bX) = \omega_i(\bX) \in \omega(F).
\end{equation*}
\begin{defi}[Logarithm and Exponential]
  The induced morphism of formal group laws
  \begin{equation*}
    f = (f_1, \dots, f_n) : F \otimes (R \otimes_A K) \to \Ghat_a^n \otimes_R (R \otimes K)
  \end{equation*}
  is called the logarithm attached to $F$, we write 
  $\log_F(\bX) \in ((R \otimes_A K)\llbr \bX \rrbr)^n$ for the corresponding collection
  of power series. The inverse of $\log_F(\bX)$ is called the exponential 
  attached to $F$, denoted $\exp_F(\bX)$. We have $\Lie(\log_F) = \Lie(\exp_F) = \id$,
  so $\log_F$ and $\exp_F$ are isomorphisms.
\end{defi}

\begin{lem}
  Let $F$ and $G$ be formal $A$-module laws over $R$, with $\dim F = n$ and
  $\dim G = m$. 
  Let $\phi: F \to G$ be a morphism. Then the diagram 
  \begin{equation*}
  \begin{tikzcd}[ampersand replacement=\&]
    {F \otimes(R \otimes_A K)} \& {\Ghat_a \otimes (\Lie(F)} \otimes_A K) =
    \Ghat_{a, R\otimes_AK}^n \\
    {G \otimes(R \otimes_A K)} \& {\Ghat_a \otimes (\Lie(G)} \otimes_A K) =
    \Ghat_{a, R\otimes_AK}^m
  	\arrow["{\log_F}", from=1-1, to=1-2]
  	\arrow["\phi"', from=1-1, to=2-1]
  	\arrow["{\Lie(\phi)}", from=1-2, to=2-2]
  	\arrow["{\log_G}", from=2-1, to=2-2]
  \end{tikzcd}
  \end{equation*}
  commutes. In particular, attached to any $\cF \in \FMArbOver AR$ comes a 
  natural morphism 
  $$\log_\cF: \cF \otimes (R \otimes_A K) \to \Ghat_{a, R\otimes_A K} \otimes
  \left(\Lie(\cF) \otimes_R (R \otimes_A K)\right).$$
  \begin{proof}
    The square commutes because $\Hom(\Ghat_{a, R\otimes_AK}^n, \Ghat_{a,
    R\otimes_AK}^m) = \Hom_{R \otimes_A K}((R\otimes_A K)^n, (R\otimes_A K)^m)$
    and $\Lie(\log_G \circ \phi \circ \exp_H) = \Lie(\phi).$
  \end{proof}
\end{lem}

\begin{lem}\label{lem:KernelOfLog}
  Let $K$ be a local field with integers $\cO_K$ and a choice of uniformizer $\varpi \in \cO_K$, 
  and let $F$ be a Lubin-Tate $\cO_K$-module law corresponding to some 
  $f \in \cF_\varpi$, cf. Theorem \ref{thm:LTModLaw}. Let $S$ be an admissible 
  $\cO_K$-algebra and let $s \in S^\cici$ be an element such that the
  series $\log_{\cF}(s)$ 
  converges. Then we have $\log_F(s) = 0$ if and only if $[\varpi]^r_F(s) = 0$ for
  some $r \in \N$. 
\begin{proof}
  Up to canonical isomorphism, $F$ is a $\cO_K$-module law with $[\varpi]_F(T) =
  \varpi T + T^q$. Now one may check that 
  \begin{equation*}
    \log_F(T) = \lim_{r \to \infty} \frac{ [\varpi]_F^r(T) }{\varpi^r} = \prod_{i=1}^\infty 
    \frac{[\varpi]^i_F(T)}{\varpi [\varpi]^{i-1}_F(T)},
  \end{equation*}
  where convergence is taken coefficient-wise. After inserting
  $s \in S^\cici$, we see that the product vanishes if and only if $[\varpi]_F^r(s) = 0$
  for some $r \in \N$. 
\end{proof}
\end{lem}
% subsection Logarithms (end)

\subsection{Formal DVR-Modules over Fields of Finite Characteristic} % (fold)
\label{sub:Formal DVR-Modules over Fields}
As above, let $A$ be a discrete valuation ring with uniformizer $\varpi$ and finite 
residue field $k$; write $q$ for the cardinality of $k$. Let $K$ denote the
field of fractions of $A$, and let $R$ be a $A$-algebra. 

We have seen in the previous section that if $R$ is a field extension of $K$,
then any morphism of formal group laws $f: F \to G$ over $R$ is either $0$
or an isomorphism, which makes the theory of formal $A$-modules over $R$ rather
bland. If $R$ is an extension of $k$, the situation becomes more interesting,
mainly because there are nontrivial (relative) Frobenius endomorphisms $\Frob: F \to F$, sending $T$ to $T^q$. 

We introduce the concept of height, which is an attempt to quantify the disorder
introduced by the Frobenius endomorphisms. This also leads to interesting
invariants of formal $A$-modules over local $A$-algebras $R$.

\begin{defi}[Height of morphisms of group laws]
  Assume that $R$ is a field extension of $k$ and $f: F \to G$ is a morphism of 
  formal groups laws over $R$, given by a formal series $f(T) \in R\llbr T \rrbr$. 
  If $f = 0$, we say that $f$ has infinite height. 
  If $f \neq 0$, the height of $f$ is defined as the largest integer $h$ such that 
  $f = g(T^{q^h})$ for some power series $g(T) = c_1 T + c_2 T^2 + \dots \in
  R\llbr T \rrbr$ with $c_1 \neq 0$. 
\end{defi}
One readily checks that if $f: \cF \to \cG$ is a morphism of formal groups over
a field extension $R$ of $k$, the height of $f$ does not depend on the choices
of group laws on $\cF$ and $\cG$. This allows us to define the height function 
attached to $f$. 
\begin{defi}[Height function]
  Let $f: \cF \to \cG$ be a morphism of formal groups over a scheme $X$.
  For a scheme-theoretic point $x \in \abs X$, let $f_x$ denote the base change of $f$ to the residue field of $x$. 
  The height function attached to $f$ is the upper semicontinuous function.
  \begin{equation} \label{eq:defheight}
    \height(f) : \abs X \to \Z_{\geq 0} \cup \{\infty\}, \quad x \mapsto 
    \height(f_x).
  \end{equation}
\end{defi}
It is not hard to see that the height function is additive, that is, we have
\begin{equation*}
  \height(f \circ g) = \height(f) + \height(g).
\end{equation*}

\begin{defi}[Isogeny]
  A morphism $f: \cF \to \cG$ of formal groups over a field $k$ is called an isogeny if
  $\ker(f)$ is a represented by a finite free $k$-scheme. More generally, a
  morphism of formal $A$-modules over a base scheme $X$ is an isogeny if and
  only if $\ker(f)$ is finite and locally free over $X$. 
\end{defi}

Isogenies can be described using the height function.

\begin{lem}
  A morphism $f: \cF \to \cG$ is a isogeny if and only if the height 
  function $\height(f)$ is locally constant with values in $\Z_{\geq 0}$. 
\end{lem}

\begin{defi}[$\varpi$-divisible $A$-module]
  We say that a formal $A$-module $H$ over $X$ is $\varpi$-divisible if 
  $[\varpi]_H$ is an isogeny. If $X$ is connected, the height of $H$ is the
  (constant) height of the endomorphism $[\varpi]_H: H \to H$. 
\end{defi}

We close this subsection with a discussion about the structure of 
formal $\cO_K$-modules over separably closed field extensions $k'$ of
$k$. 
\begin{prop}\label{prop:classificationofmodulelawsbyheight}
  Over $k'$, any two formal $\cO_K$-module laws of the same height are isomorphic.
\begin{proof}
  \cite[Proposition 1.7]{drinfel1974elliptic}.
\end{proof}
\end{prop}
In particular, any formal $\cO_K$-module of height $h$ is isomorphic to 
the formal $\cO_K$-module $F_\mathrm{norm}$ with $[\varpi]_{F_\mathrm{norm}}(T) =
  T^{q^h}$. We call this the normalized formal $\cO_K$-module.

\begin{prop}\label{prop:EndomorphismsOfFormalModulesOverksep}
  Suppose that $F \in \FMLOver {\cO_K}{k'}$. Then $\End_{\FMOver A{k'}}(F)$ is 
  isomorphic to the maximal order
  of the central division algebra $D$ over $K$ of rank $h^2$ and invariant
  $\frac 1h$.
\begin{proof}
  This is part of \cite[Proposition 1.7]{drinfel1974elliptic}
  as well. 
\end{proof}
\end{prop}

\begin{lem}\label{lem:inverseqisog}
  Let $f: F \to G$ be an isogeny of $\varpi$-divisible formal $\cO_K$-module laws
  over $k'$. Then there is an 
  integer $n \geq 0$ and an isogeny $g: G \to F$ with 
  \begin{equation*}
    f \circ g = [\varpi^n]_\cG \quad \text{and} \quad g \circ f = [\varpi^n]_\cF.
  \end{equation*}
  \begin{proof}[Proof]
    As the height is additive, we necessarily have 
    $\height(F) = \height(G)$, thus by Lemma
    \ref{prop:classificationofmodulelawsbyheight}, we may assume that $F$ and
    $G$ are given by the normalized formal $\cO_K$-module
    $F_\mathrm{norm}$.
    Write $f(T) = g(T^{q^n})$ for some power series $h(T) = c_1 T + c_2T^2 +
    \dots$, where $c_1 \neq 0$ is a unit in $k'$, and let $g(T) = h^{-1}(T)$ be the 
    formal inverse of $h$. Now $g$ is a morphism of formal $\cO_K$-module laws
    satisfying $f \circ g(T) = g\circ f(T) = T^{q^n}$. The claim follows.
  \end{proof}
\end{lem}

% subsubsection Formal DVR-Modules over Fields of Characteristic 0 (end)
% subsection over Fields (end)

\subsection{Exact Categories, Extensions of Formal Modules} % (fold)
 \label{sub:Exact Categories Extensions of Formal Modules}

In this section, we equip the category $\FMArbOver AX$, where 
$A$ is any ring and $X$ is a quasi-compact and quasi-separated $A$-scheme,
with a notion of short exact sequences. We show that this gives $\FMArbOver AX$ 
the structure of an exact category in the sense of 
Quillen \cite[Appendix A]{keller1990chain}. We introduce functors
\begin{align*}
  \Ext(-,-)&: \FMArbOver AX^\opp \times \FMArbOver AX \to \Set \\
  \RigExt(-,-)&: \FMArbOver AX^\opp \times \FMArbOver AX \to \Set,
\end{align*}
which send a pair $(\cF, \cF')$ to the set of equivalence classes of 
extensions (respectively rigidified extensions) of $\cF$ by $\cF'$. These functors
will play a major role in the discussion upcoming.

\subsubsection{The Category of Formal Modules is Exact} % (fold)
\label{ssub:The Category of Formal Modules is Exact}
Before turning our attention to formal modules, we introduce the notion of 
exact categories, following \cite[Appendix A]{keller1990chain}.

\begin{defi}[Exact Category]
  Let $\cA$ be an additive category, and let $\cE$ be a class whose
  members are exact triples of objects connected by arrows 
  \begin{equation*}
    X \xto i Y \xto d Z,
  \end{equation*}
  where $i$ is a kernel of $d$ and $d$ is a co-kernel of $i$. 
  We call a morphism $i:X \to Y$ an inflation if it appears as first component
  of some $(i,d) \in E$, second components of such pairs are called deflations.
  We say that the pair $(\cA, \cE)$ is an exact category if 
  $\cE$ is closed under isomorphisms and satisfies the following properties.
  \begin{enumerate}
    \item The identity $\id_0: 0 \to 0$ is a deflation.
    \item The composition of two deflations is a deflation.
    \item For each $f \in \Hom_\cA(Z', Z)$, there is a cartesian square
    \begin{equation*}
        \begin{tikzcd}[ampersand replacement=\&]
        	{Y'} \& {Z'} \\
        	Y \& Z
        	\arrow["{d'}", from=1-1, to=1-2]
        	\arrow["{f'}"', from=1-1, to=2-1]
        	\arrow["f", from=1-2, to=2-2]
        	\arrow["d"', from=2-1, to=2-2]
        \end{tikzcd}
    \end{equation*}
    such that $d'$ is a deflation.
  \item[3\textsuperscript{op}.] For each $f \in \Hom_\cA(X, X')$, there is a
    co-cartesian square
      \begin{equation*}
        \begin{tikzcd}[ampersand replacement=\&]
        	X \& Y \\
        	{X'} \& {Y'}
        	\arrow["i", from=1-1, to=1-2]
        	\arrow["f"', from=1-1, to=2-1]
        	\arrow["{f'}", from=1-2, to=2-2]
        	\arrow["{i'}"', from=2-1, to=2-2]
        \end{tikzcd}
      \end{equation*}
      such that $i'$ is an inflation.
  \end{enumerate}
\end{defi}

As above, suppose that $A$ is any ring and $X$ is a quasi-compact and
quasi-separated $A$-scheme. Let $\cF$, $\cE$ and $\cF'$ be formal $A$-modules
over $X$. As a primer, we note that the category $\FMArbOver AX$ is additive 
(essentially by Lemma \ref{lem:FGLAdditive}).

\begin{defi}[Short Exact Sequence]\label{def:SESofFormalModules}
  A pair of composable morphisms $\cF' \to \cE \to \cF$ in 
  $\FMArbOver A X$ is called 
  a short exact sequence if the induced sequence 
  \begin{equation*}
    0 \to \Lie(\cF') \to \Lie(\cE) \to \Lie(\cF) \to 0
  \end{equation*}
  is a short exact sequence of $\cO_X$-modules. In this case, we write
  \begin{equation*}
    0 \to \cF' \to \cE \to \cF' \to 0.
  \end{equation*}
  A pair of composable morphisms $F' \to E \to F$ in $\FMLArbOver AR$
  is called an exact sequence if it is exact after passing to 
  the respective formal modules. 
\end{defi}

\begin{lem}\label{lem:SESStandardForm}
  \todo{CONDITIONS ON R; NEED FORMAL IMPLICIT FUNCTION THEROEM!}
  Let $R$ be an $A$-algebra and let $F, F' \in \FMLArbOver AR$ be 
  formal $A$-module laws of dimensions $m$ and $n$, respectively. Write 
  $\cF', \cF \in \FMArbOver AR$ for the associated formal $A$-modules,
  and suppose that they fit into a exact sequence
  \begin{equation*}
    0 \to \cF' \xto \alpha \cE \xto \beta \cF \to 0.
  \end{equation*}
  Write $\bX$ for the variables of $F'$ and $\bZ$ for those of $F$. Then 
  there exists a (non-canonical) coordinate on $\cE$ giving rise to a formal
  $A$-module law $E$ in the variables $(\bX, \bZ)$ such that the induced morphisms
  of formal module laws are of the form 
  $\alpha(\bX) = (\bX, 0)$, $\beta(\bX, \bZ) = \bZ$. Furthermore, 
  the formal $A$-module law $E$ is of the form
  \begin{equation}\label{eq:SESStandardFormModuleLaw}
  \begin{gathered}
    E((\bX_1, \bZ_1), (\bX_2, \bZ_2)) = (F'(\bX_1, \bX_2) +_{F'} \Delta(\bZ_1,
    \bZ_2) , F(\bZ_1, \bZ_2)) \\
    \text{and} \\
    [a]_E(\bX, \bZ) = ([a]_{F'}(\bX) +_{F'} \delta_a(\bZ), [a]_F(\bZ)).
  \end{gathered}
  \end{equation}
  for some $m$-tuple of power series $\Delta \in (R\llbr \bZ_1, \bZ_2 \rrbr)^m$,
  $\delta_a \in (R\llbr \bZ \rrbr)^m$. 
\begin{proof}
  The construction of $E$ is sketched in \cite[Proposition
  6.5]{hopkins1994equivariant}. We know that $\cE \cong \spf R\llbr M \rrbr$ 
  for some free $R$-module $M$ of rank $m+n$. As we have a short 
  exact sequence on Lie-algebras, we may apply the formal implicit function
  theorem \todo{reference/proof} to obtain a section 
  $\sigma: \cF \to \cE$ of $\beta:\cE \to \cF$. 
  The datum of the morphisms $\alpha$ and $\sigma$ is equivalent to 
  morphisms
  \begin{equation*}
    \alpha^\flat: R \llbr M \rrbr \to R \llbr \bX \rrbr \quad \text{and} \quad
    \sigma^\flat: R \llbr M \rrbr \to R \llbr \bZ \rrbr
  \end{equation*}
  on affines. Taking their sum, we obtain a morphism $R \llbr M \rrbr
  \to R\llbr \bX, \bT \rrbr$. On Lie-algebras, this morphism recovers the
  isomorphism $\Lie(\cE) \cong \Lie(\cF') \oplus \Lie(\cF)$ induced by 
  $\Lie(\sigma)$. In particular, $\sigma^\flat + \alpha^\flat$ is an isomorphism
  in degree $1$, hence an isomorphism. This yields the desired
  coordinate $\cE \cong \spf R\llbr \bX, \bZ\rrbr$. The fact about the 
  structure of the formal $A$-module law $E$ follows quickly from the fact that 
  $\alpha$ and $\beta$ are morphisms of formal $A$-module laws. 
\end{proof}
\end{lem}
Let's turn our attention to the power series $(\Delta, (\delta_a)_{a\in A})$
appearing in the above Lemma. They satisfy certain conditions.
\begin{defi}[Symmetric 2-cocycles]\label{def:SymCoc2}
  Let $\SymCoc^2(F, F')$ be the set of collections of power series $(\Delta,
  (\delta_a)_{a \in A})$ satisfying the following properties
  \begin{itemize}
    \item $\Delta(\bZ_1,\bZ_2) = \Delta(\bZ_2,\bZ_1)$
    \item $\Delta(\bZ_2,\bZ_3) +_{F'} \Delta(\bZ_1, F(\bZ_2,\bZ_3)) = \Delta(F(\bZ_1,\bZ_2), \bZ_3) +_{F'} \Delta(\bZ_1,\bZ_2)$
    \item $\delta_a(\bZ_1) +_{F'} \delta_a(\bZ_2) +_{F'} \Delta([a]_F(\bZ_1), [a]_F(\bZ_2)) = 
      [a]_{F'}\Delta(\bZ_1,\bZ_2) +_{F'} \delta_a(F(\bZ_1,\bZ_2))$
    \item $\delta_a(\bZ_1) +_{F'} \delta_b(\bZ_1) +_{F'} \Delta([a]_F(\bZ_1), [b]_F(\bZ_1)) =
      \delta_{a+b}(\bZ_1)$
    \item $[a]_{F'}\delta_b(\bZ_1) +_{F'} \delta_a([b]_F(\bZ_1)) = \delta_{ab}(\bZ_1)$.
  \end{itemize}
  These objects are called symmetric $2$-cocycles. The set $\SymCoc^2(F, F')$
  is naturally a left-$\End(F')$-module.
\end{defi}
\begin{prop}\label{prop:ClassOfFGLitoSymCoc}
  There is a bijection 
  \begin{equation*}
    \SymCoc^2(F, F') \xto \sim \left\{
      \begin{gathered}
        \text{$A$-module laws $E$ on $R\llbr \bX, \bZ \rrbr$ fitting into an
        exact sequence}
        \\ 0 \to F' \xto \alpha E \xto \beta F \to 0 \\
        \text{where $\alpha(\bX) = (\bX, 0)$ and $\beta(\bX, \bZ) = \bZ$. }
      \end{gathered}
      \right\}
  \end{equation*}
  The map sends a pair $\{\Delta, (\delta_a)_a\}$ to the $A$-module law with
  structure defined following \eqref{eq:SESStandardFormModuleLaw}. 
  \begin{proof}[Proof]
    This is only a matter of calculation, cf. \cite[Section
    6]{hopkins1994equivariant}.
  \end{proof}
\end{prop}

\begin{lem}
  If $\cF'$, $\cE$ and $\cF$ are formal $A$-modules over a quasi-compact and quasi-separated $A$-scheme $X$,
  and $\alpha$ and $\beta$ are morphisms such that 
  $0 \to \cF' \xto\alpha \cE \xto\beta \cF \to 0$ 
  is a short exact sequence of formal $A$-modules, $\alpha$ is a kernel of
  $\beta$ and $\beta$ is a cokernel of $\alpha$. 
\begin{proof}
  Let $\psi: \cG \to \cE$ be a morphism of formal $A$-modules such that
  the composition $\cG \xto\psi \cE \xto\beta \cF$ is trivial. 
  We have to show that there is a unique morphism $\bar \psi: \cG \to 
  \cF'$ making the following diagram commute.
  \begin{equation*}
    \begin{tikzcd}[ampersand replacement=\&]
    	0 \& {\cF'} \& \cE \& \cF \& 0 \\
    	\&\& \cG
    	\arrow[from=1-1, to=1-2]
    	\arrow["\alpha", from=1-2, to=1-3]
    	\arrow["\beta", from=1-3, to=1-4]
    	\arrow[from=1-4, to=1-5]
    	\arrow["{\exists!\overline \psi}", dashed, from=2-3, to=1-2]
    	\arrow["{\psi}"', from=2-3, to=1-3]
    	\arrow["0"', from=2-3, to=1-4]
    \end{tikzcd}
  \end{equation*}
  As $\overline \psi$ is unique, we may work locally $X$ and assume that $X =
  \spec R$ is affine and 
  $\cF'$, $\cF$ and $\cG$ all come from formal $A$-module laws. We may
  now assume that the short exact sequence is in the form of Lemma
  \ref{lem:SESStandardForm}. Write $E$, $F$, $F'$, $G$ for the 
  formal $A$-module laws corresponding to $\cE$, $\cF$, $\cF'$ and 
  $\cG$. Write $\bY$ for the variables of $G$. Now, as 
  $\beta \circ \psi = 0$, the induced morphism of
  formal $A$-module laws $\psi: G \to E$ is of the form $\psi(\bY) =
  (\psi_1(\bY), 0)$, and we find that $\psi_1(\bY) \in (R\llbr \bY \rrbr)^m$
  yields a morphism of formal $A$-modules $G \to F'$. It is clearly unique. 
  
  Similar ideas show that $\beta$ is a cokernel of $\alpha$. 
\end{proof}

\end{lem}

\begin{lem}
  The composition of two deflations of formal $A$-modules is a deflation.
\begin{proof}
  \red{Proof is simple application of Lemma \ref{lem:SESStandardForm} but no
  time to write down} 
\end{proof}
\end{lem}

\begin{lem}
  Let $0 \to \cF' \xto\alpha \cE \xto\beta \cF \to 0$ be a short exact sequence in 
  $\FMLArbOver AX$. If $f \in \Hom_{\FMArbOver AX} \cG \to \cF$ is a morphism 
  of formal $A$-modules, then there is a formal $A$-module $f^*\cE$ 
  and a deflation $f^*\cE \to \cG$ fitting into a diagram with short exact 
  sequences as rows
  \begin{equation*}
    \begin{tikzcd}[ampersand replacement=\&]
	    0 \& {\cF'} \& {f^*\cE} \& \cG \& 0 \\
	    0 \& {\cF'} \& \cE \& \cF \& 0
	    \arrow[from=1-1, to=1-2]
	    \arrow["{\alpha'}", from=1-2, to=1-3]
	    \arrow[Rightarrow, no head, from=1-2, to=2-2]
	    \arrow["{\beta'}", from=1-3, to=1-4]
	    \arrow[from=1-3, to=2-3]
	    \arrow[from=1-4, to=1-5]
	    \arrow["f", from=1-4, to=2-4]
	    \arrow[from=2-1, to=2-2]
	    \arrow["\alpha", from=2-2, to=2-3]
	    \arrow["\beta", from=2-3, to=2-4]
	    \arrow[from=2-4, to=2-5]
    \end{tikzcd}
  \end{equation*}
  The square on the right is cartesian.
\begin{proof}
  Assume first that $X = \spec R$ is affine and that $\cF$, $\cF'$ and $\cG$ 
  come from formal $A$-module laws over $R$. Then we assume to be in the
  situation of Lemma \ref{lem:SESStandardForm}, with
  $\cE$ coming from a formal $A$-module law $E$. Using the induced morphism 
  $f: G \to F$ of formal $A$-module laws, define the $A$-module law
  law $f^* E$ via
  \begin{gather*}
    f^*E((\bX_1, \bY_1), (\bX_2, \bY_2)) = (F'(\bX_1, \bX_2) +_{F'}
    \Delta(f(\bY_1), f(\bY_2)) , G(\bY_1, \bY_2)) \\
    \text{and } \\
    [a]_{f^*E}(\bX, \bY) = ([a]_{F'}(\bX) +_{F'} \delta_a(f(\bY)), [a]_F(\bY)).
  \end{gather*}
  Here, $\Delta$ and $\delta_a$ are the power series coming from $E$ (cf.
  Lemma \ref{lem:SESStandardForm}).
  Now the top-row is exact with $\alpha'(\bX) = (\bX, 0)$ and 
  $\beta'(\bX, \bY) = \bY$. 
  The morphism of $A$-module laws $f^*E \to E$ is given by 
  $(\bX, \bY)\mapsto (\bX,f(\bY))$. One readily checks that 
  \begin{equation*}
    \begin{tikzcd}[ampersand replacement=\&]
    	{f^*E} \& G \\
    	E \& F
    	\arrow["{\beta'}", from=1-1, to=1-2]
    	\arrow[from=1-1, to=2-1]
    	\arrow["f", from=1-2, to=2-2]
    	\arrow["\beta", from=2-1, to=2-2]
    \end{tikzcd}
  \end{equation*}
  is cartesian in the category of formal $A$-module laws over $R$. 
  As the data of $\cE$ glue, the power series defining $f^*E$ glue to give
  a formal $A$-module $f^*\cE$, satisfying all of the desired properties.
\end{proof}
\end{lem}

The dual statement is also true. 
\begin{lem}
  Let $0 \to \cF' \xto \alpha \cE \xto\beta \cF \to 0$ be as above, and let
  $g \in \Hom_{\FMArbOver AX}(\cF', \cG')$ be a morphism of formal 
  $A$ modules. There is a formal $A$-module $g_*\cE$ over $X$ and an
  inflation $\alpha':\cG' \to g_*\cE$ fitting into a diagram with short 
  exact sequences
  \begin{equation*}
    \begin{tikzcd}[ampersand replacement=\&]
    	0 \& {\cF'} \& \cE \& \cF \& 0 \\
    	0 \& {\cG'} \& {g_* \cE} \& \cF \& 0
    	\arrow[from=1-1, to=1-2]
    	\arrow["\alpha", from=1-2, to=1-3]
    	\arrow["g"', from=1-2, to=2-2]
    	\arrow["\beta", from=1-3, to=1-4]
    	\arrow[from=1-3, to=2-3]
    	\arrow[from=1-4, to=1-5]
    	\arrow[Rightarrow, no head, from=1-4, to=2-4]
    	\arrow[from=2-1, to=2-2]
    	\arrow["{\alpha'}", from=2-2, to=2-3]
    	\arrow["{\beta'}", from=2-3, to=2-4]
    	\arrow[from=2-4, to=2-5]
    \end{tikzcd}
  \end{equation*}
\begin{proof}
  We proceed as in the proof of the previous lemma and assume that 
  $X = \spec R$ and that $\cF'$, $\cF$ and $\cG$ come from formal $A$-module
  laws over $R$. Now $E$ is a formal $A$-module law over $R$ of the form 
  described in Lemma \ref{lem:SESStandardForm}, and 
  using the power series $\Delta$ and $\delta_a$ we define $g_* E$ via 
  \begin{gather*}
    g_*E((\bY_1, \bZ_1), (\bY_2, \bZ_2)) = (G'(\bY_1, \bY_2) +_{G'}
    g(\Delta(\bZ_1, \bZ_2)) , F(\bZ_1, \bZ_2)) \\
    \text{and } \\
    [a]_{g_*E}(\bX, \bY) = ([a]_{G'}(\bX) +_{G'} g(\delta_a(\bZ)), [a]_F(\bZ)).
  \end{gather*}
  The morphism $E \to g_*E$ is given by $(\bX, \bZ) \mapsto (g(\bX), \bZ)$. 
  These data glue and give rise to a formal $A$-module
  $g_*\cE$ over $X$ satisfying the desired properties.
\end{proof}
\end{lem}

As a consequence of the previous lemmas, we obtain
\begin{prop}\label{prop:FMArbIsExact}
  Let $S$ be a quasi-compact and quasi-separated $S$-scheme. Then
  the category $\FMLArbOver AS$, equipped with the notion of exact sequences
  from Definition \ref{def:SESofFormalModules}, is an exact category. 
\end{prop}

The following calculation is convenient.
\begin{lem}\label{lem:LieAlgebrasOfPBandPFW}
  We have natural isomorpisms 
  \begin{equation*}
    \Lie(f^* \cE) \cong \Lie(\cE) \times_{\Lie(\cF)} \Lie(\cG) \quad \text{and}
    \quad \Lie(g_* \cE) \cong \Lie(\cG') \sqcup_{\Lie(\cF')} \Lie(\cE).
  \end{equation*}
\begin{proof}
  This is true locally, and the local descriptions descent to $X$.
\end{proof}
\end{lem}

% subsubsection The Category of Formal Modules is Exact (end)

\subsubsection{Extensions and Rigidified Extensions} % (fold)
\label{ssub:Extensions and Rigidified Extensions}
We now introduce the functors $\Ext$ and $\RigExt$. 
Let $\cF$ and $\cF'$ be formal $A$-modules over an $A$-scheme $S$.
\begin{defi}[Extension]
  An extension of $\cF$ by $\cF'$ is a short exact sequence 
  \begin{equation*}
    0 \to \cF' \to \cE \to \cF \to 0.
  \end{equation*}
  We say that this extension is equivalent to another extension 
  \begin{equation*}
    0 \to \cF' \to \cE' \to \cF \to 0
  \end{equation*}
  if and only if there is an isomorphism $\cE \to \cE'$ making the diagram 
  \begin{equation*}
    \begin{tikzcd}[ampersand replacement=\&]
    	0 \& {\cF'} \& \cE \& \cF \& 0 \\
    	0 \& {\cF'} \& {\cE'} \& \cF \& 0
    	\arrow[from=1-1, to=1-2]
    	\arrow[from=1-2, to=1-3]
    	\arrow[Rightarrow, no head, from=1-2, to=2-2]
    	\arrow[from=1-3, to=1-4]
    	\arrow[from=1-3, to=2-3]
    	\arrow[from=1-4, to=1-5]
    	\arrow[Rightarrow, no head, from=1-4, to=2-4]
    	\arrow[from=2-1, to=2-2]
    	\arrow[from=2-2, to=2-3]
    	\arrow[from=2-3, to=2-4]
    	\arrow[from=2-4, to=2-5]
    \end{tikzcd}
  \end{equation*}
  commute. We denote the set of equivalence classes of extensions of $\cF$ by
  $\cF'$ as $\Ext(\cF, \cF')$. 
\end{defi}
Proposition \ref{prop:FMArbIsExact} turns $\Ext(-,-)$ into a functor.
In particular, $\Ext(\cF,\cF')$ carries the structure of a
left-$\End(\cF')$-module,
with zero-object given by the canonical extension $\cF \oplus \cF'$.

\begin{defi}[Rigifidied Extension]
  A rigidified extension of $\cF$ by $\cF'$ is a pair consisting of an extension
  \begin{equation*}
    0 \to \cF' \to \cE \to \cF \to 0
  \end{equation*}
  and a splitting $s$ of the short exact sequence
  \begin{equation*}
    \begin{tikzcd}[ampersand replacement=\&]
      0 \& {\Lie(\cF')} \& {\Lie(\cE)} \& {\Lie(\cF)} \& 0.
  	  \arrow[from=1-1, to=1-2]
  	  \arrow["", from=1-2, to=1-3]
  	  \arrow["", from=1-3, to=1-4]
  	  \arrow["s", curve={height=-12pt}, from=1-4, to=1-3]
  	  \arrow[from=1-4, to=1-5]
    \end{tikzcd}
  \end{equation*}
  We say that two rigidified extensions $(E,s)$, $(E',s')$ are isomorphic if there 
  is an isomorphism $i: E \to E'$ of extensions such that $s' = \Lie(i) \circ s$. 
  We denote the set of isomorphism classes of rigidified extensions by 
  $\RigExt(\cF, \cF')$. 
\end{defi}
\begin{lem}
  The assignment $(\cF, \cF') \mapsto \RigExt(\cF,\cF')$ extends to 
  a functor in both entries (contravariant in the first, covariant in the
  second). 
\begin{proof}
  Given a morphism 
  $f: \cG \to \cF$, the induced morphism $\RigExt(\cF, \cF') \to 
  \RigExt(\cG, \cF')$ is given by sending the pair $(\cE,s)$ to
  the pair $(f^*\cE, s')$, where 
  \begin{equation*}
    s': \Lie(\cG) \to \Lie(f^*\cE) \cong \Lie(\cE) \times_{\Lie(\cF)} \Lie(\cG),
    \quad x \mapsto ((s \circ \Lie(f)) (x), x). 
  \end{equation*}
  Here we used the description of $\Lie(f^*\cE)$ from Lemma
  \ref{lem:LieAlgebrasOfPBandPFW}.
  Similarly, given a morphism $g: \cF' \to \cG'$, the induced morphism 
  $\RigExt(\cF, \cF') \to \RigExt(\cF, \cG')$ sends $(\cE,s)$ to
  $(g_*\cE, \Lie(g') \circ s)$, where $g': \cE \to g_* \cE$ is the 
  canonical morphism.
\end{proof}
\end{lem}
In particular, $\RigExt(-,\cF')$ carries the structure of an 
$\End(\cF')$-module, the zero-object is given by the equivalence class of 
the pair
$(\cF' \oplus \cF, s_{\mathrm{triv}})$, where 
$s_{\mathrm{triv}}: \Lie(\cF) \to \Lie(\cF') \oplus \Lie(\cF)$ is the canonical
inclusion.

Of course there is a natural transformation $\RigExt(-,-) \to \Ext(-,-)$,
forgetting the splitting. It appears as the right-most
term of an interesting exact sequence.
\begin{prop}\label{prop:InterestingES}
  There is an exact sequence of Abelian groups, functorial in
  $\cF$ and $\cF'$
  \begin{equation*}
    \Hom_{\FMArbOver AS}(\cF, \cF') \xto{\Lie} \Hom_{\QCoh {\cO_S}}(\Lie(\cF), \Lie(\cF'))
    \to \RigExt(\cF, \cF') \to \Ext(\cF, \cF'). 
  \end{equation*}
\begin{proof}
  The kernel of $\RigExt(\cF,\cF') \to \Ext(\cF,\cF')$ is given (up to
  equivalence) by 
  pairs of the form $(\cF' \oplus \cF, s)$, where $s$ is a morphism
  of quasi-coherent $\cO_S$-modules such that 
  $$ \Lie(\cF) \xto s \Lie(\cF') \oplus \Lie(\cF) \to  \Lie(\cF)$$
  is the identity. It is clear that these morphisms $s$ correspond to morphisms 
  $\Lie(\cF) \to \Lie(\cF')$. 

  The kernel of $\Hom_{\QCoh {\cO_S}}(\Lie(\cF), \Lie(\cF')) \to \RigExt(\cF,
  \cF')$ is spanned by those pairs $(\cE,s)$ that are in the same 
  class as $(\cF' \oplus \cF, s_{\mathrm{triv}})$. Any such $\cE$ fits into
  a diagram 
  \begin{equation*}
    \begin{tikzcd}[ampersand replacement=\&]
    	0 \& {\cF'} \& {\cF' \oplus \cF} \& \cF \& 0 \\
    	0 \& {\cF'} \& \cE \& \cF \& 0.
    	\arrow[from=1-1, to=1-2]
    	\arrow[from=1-2, to=1-3]
    	\arrow[Rightarrow, no head, from=1-2, to=2-2]
    	\arrow[from=1-3, to=1-4]
    	\arrow["\psi", from=1-3, to=2-3]
    	\arrow[from=1-4, to=1-5]
    	\arrow[Rightarrow, no head, from=1-4, to=2-4]
    	\arrow[from=2-1, to=2-2]
    	\arrow["\alpha", from=2-2, to=2-3]
    	\arrow["\beta", from=2-3, to=2-4]
    	\arrow[from=2-4, to=2-5]
    \end{tikzcd}
  \end{equation*}
  Working locally, we assume that $\cE$, $\cF$ and $\cF'$ come from formal 
  module laws $E$, $F$ and $F'$. Now $\psi$ is necessarily of the form
  $\psi(\bX, \bZ) = (\bX +_{F'} g(\bZ), \bZ)$. Hence, the power series
  $g$ furnishes a morphism of formal module laws $F \to F'$. This construction
  descents to a morphism of formal $A$-modules $\cF \to \cF'$, and we have 
  $$s(x) = \Lie(\psi) \circ s_{\mathrm{triv}}(x) = \Lie(\alpha)\circ\Lie(g)(x)
  + x \in \Lie(\cE).$$
  This explains exactness on the left.
\end{proof}
\end{prop}
% subsubsection Extensions and Rigidified Extensions (end)

\subsubsection{Explicit Dieudonn Theory} % (fold)
\label{ssub:Explicit Dieudonne Theory}
Let $\cF$ and $\cF'$ be formal $A$-modules of dimension $m$ and $n$ respectively,
over an affine base $\spec R$, coming from formal module laws $F$ and $F'$. We
give an explicit description of $\Ext(\cF, \cF')$ in terms of terms of the
Symmetric 2-Cocycles associated with $F$ and $F'$ (cf. Definition
\ref{def:SymCoc2}). 
We also give a related explicit description of $\RigExt(F, \Ghat_a)$ in terms of 
Quasi-Logarithms, cf. Definition \ref{def:QuasiLogarithm}. 

Write $\bX$ for the variables of $F'$ and $\bZ$ for the variables of $F$.
\begin{defi}[Symmetric $1$-Cochain] \label{def:SymCoc1}
  A symmetric $1$-cochain for the pair $(F,F')$ is an $n$-tuple of power 
  series $\bgg = (g_1, \dots, g_m)$, such that $g_i(\bZ) \in R\llbr \bZ \rrbr$
  satisfying $g_i(0) = 0$ for all $i$. We write $\delta \bgg$ 
  for the coboundary of $\bgg$, that is, the pair $(\Delta \bgg, (\delta_a
  \bgg)_{a \in A})$,
  where
  \begin{equation*}
    \Delta \bgg = \bgg(\bZ_1) -_{F'} \bgg(F(\bZ_1,\bZ_2)) +_{F'} \bgg(\bZ_2)
    \in (R\llbr \bZ_1, \bZ_2 \rrbr)^m
  \end{equation*}
  and 
  \begin{equation*}
    \delta_a \bgg = [a]_{F'} \bgg(\bZ) -_{F'} \bgg([a]_F(\bZ)) \in (R \llbr \bZ
    \rrbr)^m.
  \end{equation*}
  One readily checks that $\delta \bgg \in \SymCoc^2(F, F')$. 
\end{defi}

\begin{prop}\label{prop:ExtInTermsOfSymCoc}
  Given two extensions $\cE,\cE' \in \Ext(\cF, \cF')$, write 
  $E$, $E'$ for the respective formal $A$-module laws coming from Lemma
  $\ref{lem:SESStandardForm}$, and write
  $\Delta_E$ and $\Delta_{E'}$ for the associated symmetric $2$-cocycles (cf.
  Proposition \ref{prop:ClassOfFGLitoSymCoc}). There is a bijection
  \begin{equation*}
    \{\bgg \in (R\llbr \bZ \rrbr)^m \mid \bgg(0) = 0 \text{ and } \delta \bgg = \Delta_{E'} - \Delta_E\}
    \xto \sim \{\text{Isomorphisms of extensions } E \to E' \}.
  \end{equation*}
  Explicitly, this bijection is given by sending $\bgg$ to the morphism
  $i_\bgg \in \Hom_{\FMLArbOver A R}(E, E')$, given by 
  $i_\bgg (\bX, \bZ) = (\bX +_{F'} \bgg(\bZ), \bZ)$. In particular, there is a bijection
  \begin{equation*}
    \Ext(\cF, \cF') \cong \frac{\SymCoc^2(F, F')}{\{\delta \bgg 
    \mid \bgg \in (R\llbr \bZ \rrbr)^m \text{ with } \bgg(0) = 0\}}.
  \end{equation*}
  This bijection is an isomorphism of $\End(\cF')$-modules.
\end{prop}
For now, this finishes the study of $\Ext(\cF, \cF')$. 

Assume now that $\cF' = \Ghat_a$, and that 
$\cF$ comes from a one-dimensional formal $A$-module $F \in \FMLOver AR$. For
the remainder of this subsection, we will be concerned with the $R$-module
$\RigExt(\cF, \Ghat_a)$. The notion of Quasi-Logarithms will play a major role.

\begin{defi}[Quasi-Logarithms]\label{def:QuasiLogarithm}
  A power series $g(T) \in (R \otimes_A K) \llbr T \rrbr$ is called a 
  Quasi-Logarithm for $F$, if $g(0) = 0$ and $g'(T)$, as well as all 
  of the power series appearing in $\delta g$ (with $F' = \Ghat_a$, cf.
  Definition \ref{def:SymCoc1})
  have coefficients in $R$. We define the $R$-module
  \begin{equation*}
    \QLog(F) = \frac{\{g(T) \in (R \otimes_A K) \llbr T \rrbr \mid g \text{ is a 
    quasi-logarithm for } F\}}{\{g(T) \in R\llbr T \rrbr \mid g(0) = 0\}}
  \end{equation*}
\end{defi}

Let $(\cE,s) \in \RigExt(F,\Ghat_a)$ be a rigidified extension. 
The splitting $s$ yields an isomorphism $\omega(\cE) \cong \omega(\Ghat_a) \oplus
\omega(\cF)$ on duals, giving an invariant differential $\omega_\cE \in
\omega(\cE)$ pulling back to $\dc X$ on $\Ghat_a$. Conversely, any such invariant
differential $\omega_\cE$ yields a splitting, so the choice of $s$ is
equivalent to the choice of $\omega_E$, and we will henceforth write 
$(\cE, \omega_\cE) \in \RigExt(\cF, \Ghat_a)$. 

\begin{thm}[Classification of Rigidified Extensions in terms of Quasi-Logarithms]
  \label{thm:RigExtStr}
  There is a bijection
  \begin{equation}\label{eq:QLogBijection}
    \{\text{Quasi-logarithms for $F$}\} \xto \sim 
      \left\{
      \begin{gathered}
        \text{Pairs $(E, \omega_E)$, where $E$ is an $A$-module law} \\
        \text{fitting into  an exact sequence}
        \\ 0 \to \Ghat_a \xto \alpha E \xto \beta F \to 0 \\
        \text{with $\alpha(X) = (X, 0)$ and $\beta(X, T) = T$ and $\omega_E$} \\
        \text{is an invariant differential on $E$ with 
        $\alpha^* \omega_E = \dc X$.} \\
      \end{gathered}
      \right\}
  \end{equation}
The map sends any quasi-logarithm $g(T) \in (R\otimes_A K)\llbr T \rrbr$
to the pair $(E_{\delta g}, \dc (X + g(T)) \in \RigExt(F, \Ghat_a)$. Here
$E_{\delta g} \in \Ext(F, \Ghat_a)$ is the extension corresponding to 
$\delta g \in \SymCoc^2(F,\Ghat_a)$. 

Furthermore, given two rigidified extensions
$(E, \omega_E), (D, \omega_{D})$ with associated quasi-logarithms
$g(T)$ and $h(T)$, there is a (unique) isomorphism $(E, \omega_E) \to (D, \omega_{D})$
if and only if $h(T)-g(T) =: f(T)$ has coefficients in $R\llbr T \rrbr$. 
In this case, the isomorphism $i_f(X,T) \in \Hom_{\FMLArbOver A R}(E, D)$ is
given by $i_f(X,T) = (X+f(T), T)$. In particular, there is a canonical bijection
\begin{equation*}
  \QLog(F) \xto \sim \RigExt(F, \Ghat_a).
\end{equation*}
This bijection is an isomorphism of $R$-modules.
\begin{proof}[Proof]
  We construct an inverse of the map in \eqref{eq:QLogBijection}. Let $(E,
  \omega_E)$ be an element of the set on the right
  and let $(\Delta, (\delta_a)_{a \in A}) \in
  \SymCoc^2(F, \Ghat_a)$ be the symmetric 2-cochain corresponding to $E$.
  Following Proposition \ref{prop:loginvdiff}, the datum of 
  $\omega_E \in \omega(E)$ is equivalent to a morphism 
  $$f_E \in \Hom_{\FMLOver A {R \otimes K}}(E \otimes_R (R \otimes_A K), \Ghat_a)
  \quad \text{satisfying} \quad f_E(X,T) = X + g(T)$$
  for some $g(T) \in (R \otimes_A K)\llbr T \rrbr$. The fact that 
  $f_E$ is a homomorphism implies that 
  \begin{multline*}
    X_1 + X_2 + \Delta(T_1, T_2) + g(F(T_1,T_2)) = f_E(E((X_1, T_1), (X_2, T_2))) = \\
    = f_E(X_1, T_1) + f_E(X_2, T_2)) = X_1 + g(T_1) + X_2 + g(T_2),
  \end{multline*}
  thereby $\Delta g = \Delta(T_1, T_2) \in R\llbr T_1, T_2\rrbr$. Similarly, 
  we find $\delta_a g = \delta_a \in R\llbr T \rrbr$. Hence, $g(T)$ is a
  quasi-logarithm with $\delta g = (\Delta, (\delta_a)_a)$. 
  This construction yields the desired inverse.
  The remaining statements are verified directly, also cf. \cite[Section
  8]{hopkins1994equivariant}.
\end{proof}
\end{thm}

Now, let $A$ be a complete, discrete valuation ring with 
uniformizing parameter $\varpi$ and finite residue field $k$. 
\begin{prop} \label{prop:ExplicitInterestingES}
  Let $\cF$ be a one-dimensional formal $A$-module law over a flat, local
  $A$-algebra $R$, and suppose that $\cF' = \Ghat_a$.
  The short exact sequence of Proposition \ref{prop:InterestingES}
  fits into a commutative diagram with 
  exact rows and vertical maps isomorphisms induced by 
  any choice of coordinate $\cF = \FGG(F)$.
\begin{equation*}
\begin{tikzcd}[ampersand replacement=\&]
  {\Hom(\cF,\Ghat_a)} \& {\omega(\cF)} \& {\RigExt(\cF,\Ghat_a)} \&
  {\Ext(\cF,\Ghat_a)} \\ 
  \begin{array}{c} \left\{\begin{gathered} f \in TR\llbr T \rrbr : \\  \delta f
    = 0\end{gathered}  \right\} \end{array} \& \begin{array}{c}
    \left\{\begin{gathered} f \in (R\otimes_A K)\llbr T \rrbr : \\ 
  \text{$\delta f = 0$, $f(0) = 0$} \\
    \text{and $f'(T) \in R\llbr T \rrbr$}\end{gathered} \right\} \end{array} \& {\QLog(F)} \&
    {\frac{\SymCoc^2(F, \Ghat_a)}{\{\delta g \mid g \in T R\llbr T \rrbr\}}}
	\arrow[hook, "{\dc_F}", from=1-1, to=1-2]
	\arrow[from=1-1, to=2-1]
	\arrow[from=1-2, to=1-3]
	\arrow[from=1-2, to=2-2]
	\arrow[two heads, from=1-3, to=1-4]
	\arrow[from=1-3, to=2-3]
	\arrow[from=1-4, to=2-4]
	\arrow[hook, from=2-1, to=2-2]
	\arrow[from=2-2, to=2-3]
	\arrow["\delta", two heads, from=2-3, to=2-4]
\end{tikzcd}
\end{equation*}
\begin{proof}
  Injectivity of $\dc_F$ is provided by Proposition \ref{prop:loginvdiff},
  and related to the original exact sequence as $\Hom_R(\Lie(\cF), \Lie(\Ghat_a)) = 
  \omega(\cF)$.
  Surjectivity of $\RigExt(\cF, \Ghat_a) \to \Ext(\cF, \Ghat_a)$ comes from the
  fact that $\Lie(\cF)$ is projective. 
  The first vertical map is an isomorphism by definition. 
  The vertical arrow describing $\omega(F)$ is obtained by
  identifying the preimage of $\omega(F) \subseteq \omega(F \otimes_R (R
  \otimes_AK))$ under the isomorphism 
  \begin{equation*}
    \{f \in T(R \otimes_A K)\llbr T \rrbr \mid \delta f = 0\} = \Hom_{\FMLOver A
    {R \otimes_A K}} (F \otimes (R \otimes_A K), \Ghat_a) \xto{\dc_F} \omega(F
    \otimes_R (R \otimes_AK)).
  \end{equation*}
  All squares commute by construction.
\end{proof}
\end{prop}

We admit the following facts from Section 9 of \cite{hopkins1994equivariant}.
\begin{prop}\label{prop:InterestingSequenceStdMod}
  Let $F$ be a formal $A$-module law of height $h$ over a local, adic
  $A$-algebra $R$. Write $\cF$ for the formal $A$-module coming from 
  $F$. Then $\Ext(\cF, \Ghat_a)$ is a free $R$-module of rank $n-1$, 
  $\RigExt(\cF, \Ghat_a)$ is a free $R$-module of rank $n$. 
\begin{proof}
  This is Proposition 9.8 in \cite{hopkins1994equivariant}. The authors make
  use of a description of $\Ext(F, \Ghat_a)$ in terms of deformation theory
  and combine it with a convenient normal form of formal $A$-modules, so called
  $A$-typical modules (we touch upon the theory in Section \ref{sub:Hazewinkels
  FuncEq and the Standard Formal Module}), to construct an explicit 
  basis for the corresponding modules. 
\end{proof}
\end{prop}
As a corollary, the authors obtain
\begin{lem}
  If $R \to R'$ is a homomorphism of local $A$-algebras, the induced maps 
  of free $R'$-modules
  \begin{gather*}
    \Ext_R(\cF, \Ghat_a) \otimes_R R' \to \Ext_{R'}(\cF, \Ghat_a) \\
    \RigExt_R(\cF, \Ghat_a) \otimes_R R' \to \RigExt_{R'}(\cF, \Ghat_a)
  \end{gather*}
  are isomorphisms.
\begin{proof}
  \cite[Corollary 9.13]{hopkins1994equivariant}.
\end{proof}
\end{lem}

\begin{defi}[The Dieudonn\'e module of a formal $A$-module]\label{def:DioModule}
  Given $\cF \in \FMOver AR$, we define 
  $$\Dio(\cF) \coloneqq \Hom_R(\RigExt(\cF, \Ghat_a), R).$$ 
  We call $\Dio(\cF)$ the (covariant) Dieudonn\'e-module of $\cF$. 
\end{defi}

\begin{prop}[Crystalline Nature of $\Dio(-)$]\label{prop:DioCrystalline}
  The assignment $\cF \mapsto \Dio(\cF)$ yields a functor
  \begin{equation*}
    \FMOver AR \to \Mod R.
  \end{equation*}
  Given two formal $A$-modules $\cF, \cG \in \FMOver AR$ and two morphisms
  $\phi, \psi$ from $\cF$ to $\cG$ such that the induced morphisms of their reductions
  to $R/I$ agree, the induced morphisms $\Dio(\cF) \to \Dio(\cG)$ agree.
  \begin{proof}
    \todo{!!!} 
  \end{proof}
\end{prop}
% subsubsection Explicit Dieudonne Theory (end)

% subsection Exact Categories, Extensions of Formal Modules (end)

\subsection{Hazewinkel's Functional Equation Lemma and the Standard Formal Module Law} % (fold)
\label{sub:Hazewinkels FuncEq and the Standard Formal Module}
If, $A$ is an integral domain and $R$ is a flat $A$-module, the structure of a formal
$A$-module $F$ over $R$ is uniquely determined by its logarithm $\log_H
\in R \otimes_A K \llbr T \rrbr$. Indeed, we find
\begin{equation*}
  F(X,Y) = \exp_H(X+Y), \quad [a]_F(X) = \exp_H(a X).
\end{equation*}
It is therefore natural to wonder about conditions on power series $f \in
(R\otimes_A K) \llbr T \rrbr$ ensuring that $f$ is the logarithm of some
formal group law. Hazewinkel found such a condition in his functional equation
lemma.

\begin{thm}[Hazewinkel's Functional Equation Lemma]\label{thm:HazewinkelIntegrality}
  Let $p$ be a prime and $q = p^e$. Given an inclusion of rings $B \subseteq
  L$, an ideal $\fa \subseteq B$ containing $p$, an endomorphism of rings
  $\sigma: L \to L$ and elements $s_1, s_2, \dots \in L$ subject to the conditions
  that 
  \begin{equation*}
    \sigma(b) \equiv b^q \pmod \fa \text{ for all } b \in B \quad \text{and} \quad 
    \sigma^r(s_i) \fa \subset B \text{ for all } r,s \geq 1.
  \end{equation*}
  Suppose now that $f \in L\llbr T \rrbr$ has $f'(0) \in L^\times$ and
  satisfies the functional equation condition
  \begin{equation*}
    f(X) - \sum_{i=1}^\infty s_i (\sigma^i_* f)(X^{q^i}) \in B\llbr X \rrbr.
  \end{equation*}
  Then we have 
  \begin{equation*}
    F(X,Y) = f^{-1}(f(X) + f(Y)) \in B \llbr X,Y \rrbr,
  \end{equation*}
  where $f^{-1}$ is the inverse power series as in Lemma \ref{lem:IsosCheckOnLie}.
  Also, if $g(Z) \in L\llbr Z \rrbr$ is another power series satisfying the 
  same condition
  \begin{equation*}
    g(Z) - \sum_{i=1}^\infty s_i (\sigma^i_* f)(Z^{q^i}) \in B\llbr Z \rrbr,
  \end{equation*}
  then $f^{-1}(g(Z)) \in B\llbr Z \rrbr$. 
  Furthermore, if $\alpha(T) \in B\llbr T \rrbr$ and $\beta(T) \in B \llbr T \rrbr$, then
  \begin{equation} \label{eq:funceqlemcongruence}
    \alpha(T) \equiv \beta(T) \pmod {\fa^r} \iff f(\alpha(T)) \equiv f(\beta(T))
    \pmod {\fa^r}
  \end{equation}

  \begin{proof}
    A more general statement can be found in \cite[Section
    2]{hazewinkel1979funceqexp}. Proofs can be found in \cite[Sections 2 and
    10]{hazewinkel1978formal}.
  \end{proof}
\end{thm}
Note that by construction, $F(X,Y)$ as defined above yields a (commutative)
formal group law over $B$. 
Let $B^\sigma$ denote the subring of elements in $B$ fixed by $\sigma$. Then 
the second part of the Functional Equation Lemma implies that we even obtain
formal $B^\sigma$-modules with $[b]_F(T) = f^{-1}(b f(T))$, as $bf(T)$
satisfies the same functional equation if $b \in B^\sigma$. 

We now enter the situation where $K$ is a local field with ring of integers
$\cO_K$ and uniformizer $\varpi$ and 
use the Functional Equation Lemma to construct Lubin--Tate Formal Group Laws. 
A special role will play the power series
\begin{equation*}
  f(T) = \sum_{i=1}^\infty \frac{T^{q^{in}}}{\varpi^i} \in K\llbr T \rrbr.
\end{equation*}
It satisfies the functional equation
\begin{equation*}
  f(T) = T + \frac 1\varpi f(T^{q^n}),
\end{equation*}
which is a functional equation of the form above, with 
$B = \cO_K$, $\fa = (\varpi)$, $L = K$, $s_1 = \varpi^{-1}$, $s_2 = s_3 = \dots = 0$,
$\sigma = \id_L$. 
Hence $f$ arises as the logarithm of a formal $\cO_K$-module law $H$ over $\cO_K$.
The fact that $f^{-1}(X) = X - \frac 1\varpi X^{q^n} + \dots$ reveals
$[\varpi]_H(T) \equiv \varpi T$ mod $(T^2)$. Additionally, note that 
\begin{equation*}
  f([\varpi]_H(T)) = \varpi f(T) = \varpi T + f(T^{q^n}) \equiv f(T^{q^n}) \pmod \varpi.
\end{equation*}
Hence, the equivalence in \eqref{eq:funceqlemcongruence} implies that 
$[\varpi]_H(T) \equiv T^{q^n}$ mod $\varpi$. So $H$ is a Lubin--Tate formal $\cO_K$-module
law of height $n$, we call it the standard Lubin--Tate formal module law of
height $n$. 
\begin{rmk} 
  The formal $\cO_K$-module $H$ is a member of the class of so called $A$-typical
  formal modules - formal $A$-modules $F$ with logarithm of the 
  form
  \begin{equation*}
    \log_F(T) = \sum_{i=0}^\infty b_i X^{q^i}
  \end{equation*}
  for elements $b_0, b_1, \dots \in R \otimes_A K$ (cf. \cite[Definition
  21.5.5 and Criterion 21.5.9]{hazewinkel1978formal}). If $R$ is flat over $A$,
  every formal $A$-module over $R$ is isomorphic to an $A$-typical one
  (cf. \cite[21.5.6]{hazewinkel1978formal}). Most results about the standard
  $\cO_K$-module $H$ remain true for general $\cO_K$-typical formal module laws.
\end{rmk}

It will be convenient to make the terms in the exact sequence of Proposition 
\ref{prop:ExplicitInterestingES} explicit for $\cF = \FGG(H)$. As $H$ is of height $n>0$, 
there is no non-trivial map $H \to \Ghat_a$ and the sequence becomes
\begin{equation*}
\begin{tikzcd}[ampersand replacement=\&]
	0 \& {\omega(H)} \& {\RigExt(H,\Ghat_a)} \& {\Ext(H,\Ghat_a)} \& 0 \\
	0 \& \begin{array}{c} \left\{\begin{gathered} {g \in TK\llbr T \rrbr : \delta g = 0} \\          \text{ and $g'(T) \in \cO_K\llbr T \rrbr$}\end{gathered} \right\} \end{array} \& {\QLog(H)} \& {\frac{\SymCoc^2(H, \Ghat_a)}{\{\delta g \mid g \in T \cO_K\llbr T \rrbr\}}} \& 0.
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-2, to=1-3]
	\arrow[from=1-2, to=2-2]
	\arrow[from=1-3, to=1-4]
	\arrow[from=1-3, to=2-3]
	\arrow[from=1-4, to=1-5]
	\arrow[from=1-4, to=2-4]
	\arrow["", from=2-1, to=2-2]
	\arrow[from=2-2, to=2-3]
	\arrow["\delta", from=2-3, to=2-4]
	\arrow[from=2-4, to=2-5]
\end{tikzcd}   
\end{equation*}
This allows us to formulate the following result.
\begin{prop}
  The $R$-module $\omega(H)$ is free of rank $1$, generated by 
  $f(T) = \log_H(T)$. $\QLog(H)$ is free of rank $n$, generated by the classes of
  $(f(T), \frac 1\varpi f(T^q), \dots, \frac 1\varpi f(T^{q^{n-1}}))$. Consequently,
  the short exact sequence above is given by 
  \begin{equation*}
    0 \to \left \langle f(T) \right \rangle \to \left \langle f(T), \frac 1\varpi
      f(T^q) , \dots,
    \frac 1\varpi f(T^{q^{n-1}}) \right \rangle \xto \delta 
    \left \langle \delta \left(\frac 1\varpi f(T^q)\right),\dots, \delta
    \left(\frac 1\varpi f(T^{q^{n-1}})\right ) \right \rangle \to 0.
  \end{equation*}
\begin{proof}
  A simple calculation shows that $\frac 1\varpi f(T^{q^k})$ is a quasi-logarithm for 
  $1 \leq k \leq n-1$. As $\delta f = 0$, we have $f(T) \in \QLog(F)$ as well. 
  The claim is \cite[Proposition 13.8]{hopkins1994equivariant} which is a 
  special case of [ibid., Proposition 9.8].
\end{proof}
\end{prop}
% subsubsection Deformations of Formal Modules and the Standard Formal Module (end)

\subsection{The Universal Additive Extension} % (fold)
\label{sub:The Universal Additive Extension}
We follow \cite[Section 11]{hopkins1994equivariant}, 
and specialize to the situation where $A$ is a complete discrete valuation ring
with uniformizer $\varpi$ and finite residue field of characteristic $p$ and
$R$ is a local admissible $A$-algebra with residue field $\bar \FF_q$.

\begin{lem}
  Let $M$ be a finite free module over $R$. Then there is a natural bijection,
  functorial in $M$ and $\cF$
  \begin{equation*}
    \Ext(\cF, \Ghat_a \otimes M) \cong \Ext(\cF, \Ghat_a) \otimes_R M.
  \end{equation*}
\begin{proof}
  After choosing coordinates on $\cF$, this follows directly from the 
  description of $\Ext$ in terms of symmetric 2-cocycles, cf. Propositions
  \ref{prop:ClassOfFGLitoSymCoc} and \ref{prop:ExtInTermsOfSymCoc}.
\end{proof}
\end{lem}

Let $\cF$ be a one-dimensional formal $A$-module over $R$.
We put $\mathrm M(\cF) \coloneqq \Hom_R(\Ext(\cF, \Ghat_a), R)$, which is free of
rank $n-1$, and
write $\cV = \Ghat_a \otimes \mathrm M(\cF)$. Now, by the previous lemma,
\begin{equation*}
  \Ext(\cF,\cV) = \Ext(\cF, \Ghat_a \otimes \mathrm M(\cF)) = \End_R(\Ext(\cF, \Ghat_a)). 
\end{equation*}
Let $0 \to \cV \to \cE \to \cF \to 0$ be the extension corresponding to the identity 
on the right. This class is unique up to unique isomorphism. Indeed, 
as $R$ is a local ring we may choose formal module laws $F$ and $V$ giving rise
to $\cF$ and $\cV$, and let $E$ be the module law obtained from 
Lemma \ref{lem:SESStandardForm}. 
If $0 \to V \to E' \to F \to 0$ is another extension in this class, we
have by construction a commutative square
\begin{equation*}
\begin{tikzcd}[ampersand replacement=\&]
	0 \& {V} \& E \& F \& 0 \\
	0 \& {V} \& {E'} \& F \& 0,
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-2, to=1-3]
	\arrow[Rightarrow, no head, from=1-2, to=2-2]
	\arrow[from=1-3, to=1-4]
	\arrow["i", from=1-3, to=2-3]
	\arrow[from=1-4, to=1-5]
	\arrow[Rightarrow, no head, from=1-4, to=2-4]
	\arrow[from=2-1, to=2-2]
	\arrow[from=2-2, to=2-3]
	\arrow[from=2-3, to=2-4]
	\arrow[from=2-4, to=2-5]
\end{tikzcd}
\end{equation*}
and by Proposition \ref{prop:ExtInTermsOfSymCoc} we see that 
any other isomorphism $i'$ making the diagram above commute differs from
$i$ by an element in $\Hom(F, V) = 0$. 

\begin{defi}[Universal Additive Extension]
  The extension
  \begin{equation*}
    0 \to \cV \to \cE \to \cF \to 0
  \end{equation*}
  constructed above is called the universal additive extension of $\cF$.
\end{defi}

\begin{prop}
  If $N$ is a finite, free $R$-module, $\cG' = \Ghat_a \otimes N$ and 
  \begin{equation*}
    0 \to \cG' \to \cE' \to F \to 0
  \end{equation*}
  is an extension of $\cF$ by $\cG'$, there are unique homomorphisms
    $i: \cE \to \cE'$ and $g': \cV \to \cG'$ making the diagram
  \begin{equation*}
\begin{tikzcd}[ampersand replacement=\&]
	0 \& {\cV} \& \cE \& \cF \& 0 \\
	0 \& {\cG'} \& {\cE'} \& \cF \& 0
	\arrow[from=1-1, to=1-2]
	\arrow[from=1-2, to=1-3]
	\arrow["{g'}"', from=1-2, to=2-2]
	\arrow[from=1-3, to=1-4]
	\arrow["i", from=1-3, to=2-3]
	\arrow[from=1-4, to=1-5]
	\arrow[Rightarrow, no head, from=1-4, to=2-4]
	\arrow[from=2-1, to=2-2]
	\arrow[from=2-2, to=2-3]
	\arrow[from=2-3, to=2-4]
	\arrow[from=2-4, to=2-5]
\end{tikzcd}
  \end{equation*}
  commute. In particular, we have $\cE' = g'_* \cE$. 
\begin{proof}
  As $\cV$ and $\cG'$ are additive, we have
  \begin{equation*}
    \Hom(\cV, \cG') = \Hom_R(\mathrm M(\cF), N) = \Ext(\cF, \Ghat_a) \otimes N =
    \Ext(\cF, \cG').
  \end{equation*}
  This yields $g'$. Again, $i$ is unique as by observations similar to 
  Proposition \ref{prop:ExtInTermsOfSymCoc}, the difference of two
  morphisms $i,i':\cE \to \cE'$ is given a morphism $\cF \to \cG'$, which has
  to be trivial.
\end{proof}
\end{prop}

\begin{lem}\label{lem:LieAlgOfUnivAddExt}
  There is a natural isomorphism $\Lie(\cE) \xto \sim \Hom(\RigExt(\cF, \Ghat_a), R) 
  = \Dio(\cF)$.
\begin{proof}
  We show the equivalent statement $\omega(\cE) = \RigExt(\cF, \Ghat_a)$. 
  Let $(\cE', \omega_{\cE'}) \in \RigExt(\cF, \Ghat_a)$. Then by universality of 
  $\cE$, we obtain a unique homomorphism $i: \cE \to \cE'$. This yields a 
  homomorphism of $R$-modules $\RigExt(\cF, \Ghat_a) \to \omega(\cE)$, 
  sending a pair $(\cE', \omega_{\cE'})$ to $i^*\omega_{\cE'}$. This morphism
  fits into the following commutative diagram, where the top row is 
  the short exact sequence from Proposition \ref{prop:ExplicitInterestingES}
  and the bottom row is the dual short exact sequence of 
  $0 \to \Lie(\cV) \to \Lie(\cE) \to \Lie(\cF) \to 0$.
  \begin{equation*}
  \begin{tikzcd}[ampersand replacement=\&]
  	0 \& {\omega(\cF)} \& {\RigExt(\cF, \Ghat_a)} \& {\Ext(\cF, \Ghat_a)} \& 0 \\
  	0 \& {\omega(\cF)} \& {\omega(\cE)} \& {\omega(\cV)} \& 0
  	\arrow[from=1-1, to=1-2]
  	\arrow[from=1-2, to=1-3]
  	\arrow[Rightarrow, no head, from=1-2, to=2-2]
  	\arrow[from=1-3, to=1-4]
  	\arrow[from=1-3, to=2-3]
  	\arrow[from=1-4, to=1-5]
  	\arrow[Rightarrow, no head, from=1-4, to=2-4]
  	\arrow[from=2-1, to=2-2]
  	\arrow[from=2-2, to=2-3]
  	\arrow[from=2-3, to=2-4]
  	\arrow[from=2-4, to=2-5]
  \end{tikzcd}
  \end{equation*}
  Thereby, $\RigExt(\cF, \Ghat_a) \to \omega(\cE)$ is a natural isomorphism.
\end{proof}
\end{lem}
% subsection The Universal Additive Extension (end)

\end{document}
